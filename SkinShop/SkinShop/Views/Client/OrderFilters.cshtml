@model SkinShop.Models.ViewModels.OrdersVM

@foreach (var i in Model.Orders)
{
    <div class="mainblock col-md-10 col-md-offset-1">
        @if (i.Client != null)
        {
            <div class="client col-md-12">
                <a href="@Url.Action("UserInfo", "Account", new { name = i.Client.User.Email })">
                    <div class="clientname">Клиент: @i.Client.User.Name</div>
                    <div class="clientphonenumber">Номер телефона: @i.Client.User.PhoneNumber</div>
                </a>
            </div>
        }
        <div class="skins col-md-10 col-md-offset-1">
            @foreach (var j in i.OrderCounts)
            {
                <div class="linkblock">
                    <a href="@Url.Action("SkinDetails", "Home", new { id = j.Skin.Id })" class="linkskin">
                        <div class="image">
                            @if (j.Skin.Images.FirstOrDefault() != null)
                            {
                                <img src="@String.Format("data:image/gif;base64,{0}", Convert.ToBase64String(j.Skin.Images.FirstOrDefault().Photo))" alt="@j.Skin.Images.FirstOrDefault().Text" class="img-responsive imgcustom">
                            }
                        </div>
                        <div class="textskin">
                            <div class="nameskin">
                                @j.Skin.Name
                            </div>
                            <div class="price">
                                @if (j.Skin.Sale > 0)
                                {
                                    <div class="oldprice">@j.Skin.Price uah</div>
                                    <div class="newprice">@(j.Skin.Price - ((j.Skin.Price * j.Skin.Sale) / 100)) uah</div>
                                }
                                else
                                {
                                    <div class="newprice">@j.Skin.Price uah</div>
                                }
                            </div>
                            <div class="characteristics">
                                <div class="gamename">
                                    <span class="addtext"><span class="glyphicon glyphicon-record"></span> Игра:</span> @j.Skin.Game.Name
                                </div>
                                <div class="type">
                                    <span class="addtext"><span class="glyphicon glyphicon-record"></span> Тип:</span> @j.Skin.SkinType.TypeName
                                </div>
                                <div class="rarity" style="color: @j.Skin.SkinRarity.Color">
                                    <span class="addtext"><span class="glyphicon glyphicon-record"></span> Редкость:</span> @j.Skin.SkinRarity.RarityName
                                </div>
                            </div>
                        </div>
                        <div class="count">
                            Количество: @j.Count
                        </div>
                    </a>
                </div>
            }
        </div>
        <div class="col-md-12 downblock">
            <div class="allprice">
                Общая стоимость: <span class="newprice">@i.Price uah</span>
            </div>
            <div class="dateblock">
                Дата оформления заказа: <span class="date">@i.OrderTime.ToShortDateString()</span>
            </div>
            <div class="status">
                Статус: <span class="text-info">@i.Status</span>
                <div class="buttons">
                    @if (User.IsInRole("manager"))
                    {
                        <div class="employeeblock">
                            @if (i.Status == SkinShop.Models.SkinShop.OrderStatusDM.NotConfirmed)
                            {
                                <div class="confirm">
                                    <a class="btn btn-success form-control" href="@Url.Action("ConfirmOrder", "Client", new { id = i.Id})">Подтвердить</a>
                                </div>
                                <div class="reject">
                                    <a class="btn btn-danger form-control" href="@Url.Action("Reject", "Client", new { id = i.Id})">Отклонить</a>
                                </div>
                            }
                            @if (i.Status == SkinShop.Models.SkinShop.OrderStatusDM.Rejected)
                            {
                                <div class="confirm">
                                    <a class="btn btn-success form-control" href="@Url.Action("ConfirmOrder", "Client", new { id = i.Id})">Подтвердить</a>
                                </div>
                            }
                        </div>
                    }
                </div>
            </div>
        </div>
    </div>
}

<script type="text/javascript">
    function Reset() {
        document.getElementById('form0').reset();
        Submit();
    }

    function Submit() {
        $('#submit').click();
    }

    $('#minprice').change(function (event) {
        let max = $('#maxprice').val();
        if (event.target.value > max) {
            $('#minprice').val(max);
        }
    });

    $('#maxprice').change(function (event) {
        let min = $('#minprice').val();
        if (event.target.value < min) {
            $('#maxprice').val(min);
        }
    });
</script>